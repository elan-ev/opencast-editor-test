(this["webpackJsonpopencast-editor"]=this["webpackJsonpopencast-editor"]||[]).push([[0],{169:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);n(12);var a,r=n(0),s=n.n(r),i=n(13),c=n.n(i),o=(n(169),n(14)),l=n(2),u=n(16),d=n(9),b=n(5),j=n(17);!function(e){e.cutting="Cutting",e.metadata="Metadata",e.thumbnail="Thumbnail",e.finish="Finish"}(a||(a={}));var f,p,x,g={value:a.cutting},h=Object(j.c)({name:"mainMenuState",initialState:g,reducers:{setState:function(e,t){e.value=t.payload}}}),m=h.actions.setState,v=function(e){return e.mainMenuState.value},O=h.reducer,y=Object(j.c)({name:"finishState",initialState:{value:"Start processing",pageNumber:0},reducers:{setState:function(e,t){e.value=t.payload},setPageNumber:function(e,t){e.pageNumber=t.payload}}}),w=y.actions,S=w.setState,k=w.setPageNumber,I=function(e){return e.finishState.value},C=function(e){return e.finishState.pageNumber},E=y.reducer,A=n(21),N=n.n(A),P=n(28),D=n(124),T=n.n(D),L=n(52),R=n.n(L),G={mediaPackageId:void 0,opencast:{url:window.location.origin,name:void 0,password:void 0},metadata:{show:!0},thumbnail:{show:!0}},M=function(){var e=Object(P.a)(N.a.mark((function e(){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W().then((function(e){f=H(e,!1,"src-server","from server settings file")}));case 2:t=new URLSearchParams(window.location.search),n={},t.forEach((function(e,t){var a=n,r=t.split(".");r.slice(0,-1).forEach((function(e){e in a||(a[e]={}),a=a[e]})),a[r[r.length-1]]=e})),p=H(n,!0,"src-url","given as URL GET parameter"),x=V.all([G,f,p]);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(P.a)(N.a.mark((function e(){var t,n,a,r,s,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n="/214/2021-03-12_14-34-25").endsWith("/")||(n+="/"),a=Object({NODE_ENV:"production",PUBLIC_URL:"/214/2021-03-12_14-34-25",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SETTINGS_PATH||"editor-settings.toml",r=a.startsWith("/")?"":n,s="".concat(window.location.origin).concat(r).concat(a),e.prev=5,e.next=8,fetch(s);case 8:i=e.sent,e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(5),console.warn("Could not access '".concat(a,"' due to network error!"),e.t0||""),e.abrupt("return",null);case 15:if(404!==i.status){e.next=20;break}return console.debug("'".concat(a,"' returned 404: ignoring")),e.abrupt("return",null);case 20:if(i.ok){e.next=23;break}return console.error("Fetching '".concat(a,"' failed: ").concat(i.status," ").concat(i.statusText)),e.abrupt("return",null);case 23:if(!(null===(t=i.headers.get("Content-Type"))||void 0===t?void 0:t.startsWith("text/html"))){e.next=26;break}return console.warn("'".concat(a,"' request has 'Content-Type: text/html' -> ignoring...")),e.abrupt("return",null);case 26:return e.prev=26,e.t1=T.a,e.next=30,i.text();case 30:return e.t2=e.sent,e.abrupt("return",(0,e.t1)(e.t2));case 34:throw e.prev=34,e.t3=e.catch(26),console.error("Could not parse '".concat(a,"' as TOML: "),e.t3),new SyntaxError("Could not parse '".concat(a,"' as TOML: ").concat(e.t3));case 38:case"end":return e.stop()}}),e,null,[[5,11],[26,34]])})));return function(){return e.apply(this,arguments)}}(),H=function(e,t,n,a){var r=function(e,t,n){return"function"===typeof e?s(e,t,n):i(e,t,n)},s=function(e,r,s){try{var i=e(r,t,n);return void 0===i?r:i}catch(c){return console.warn("Validation of setting '".concat(s,"' (").concat(a,") with value '").concat(r,"' failed: ")+"".concat(c,". Ignoring.")),null}},i=function(e,t,n){var s={};for(var i in t){var c=n?"".concat(n,".").concat(i):i;if(i in e){var o=r(e[i],t[i],c);null!==o&&(s[i]=o)}else console.warn("'".concat(c,"' (").concat(a,") is not a valid settings key. Ignoring."))}return s};return r(U,e,"")},B={string:function(e,t){if("string"!==typeof e)throw new Error("is not a string, but should be")},boolean:function(e,t){if("boolean"!==typeof e){if(t){if("true"===e)return!0;if("false"===e)return!1;throw new Error("can't be parsed as boolean")}throw new Error("is not a boolean")}}},U={mediaPackageId:B.string,opencast:{url:B.string,name:B.string,password:B.string},metadata:{show:B.boolean},thumbnail:{show:B.boolean}},V=function(e,t){return R()(e,t,{arrayMerge:F})};V.all=function(e){return R.a.all(e,{arrayMerge:F})};var F=function(e,t,n){return t},z=n(125),K=n.n(z);var Y=function(){return Object(l.jsx)(l.Global,{styles:_})},_=Object(l.css)({emotionNormalize:K.a,body:{backgroundColor:"snow",fontSize:"medium",minHeight:"100vh"}},"",""),q=Object(l.css)({borderRadius:"10px",cursor:"pointer",transitionDuration:"0.3s",transitionProperty:"transform","&:hover":{transform:"scale(1.1)"},"&:focus":{transform:"scale(1.1)"},"&:active":{transform:"scale(0.9)"},display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",textAlign:"center"},"",""),J={name:"1666ohp",styles:"width:200px;padding:16px;box-shadow:0 0 10px rgba(0, 0, 0, 0.3);justify-content:space-around"},X=Object(l.css)({display:"flex",flexDirection:"row",gap:"20px"},"",""),$={name:"651ll8",styles:"position:absolute;left:-99999px;height:1px;width:1px;overflow:hidden"},Q=function(e){return Object(l.css)(Object(o.a)(Object(o.a)({},!e&&{display:"none"}),{},{borderColor:"red",borderStyle:"dashed",fontWeight:"bold",padding:"10px"}),"","")},Z=n(153);function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(P.a)(N.a.mark((function e(t){var n,a,r,s,i,c,l,u,d,b,j=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j.length>1&&void 0!==j[1]?j[1]:{},a=n.body,r=Object(Z.a)(n,["body"]),s={"Content-Type":"application/json"},i={},x.opencast.name&&x.opencast.password&&(c=btoa(unescape(encodeURIComponent(x.opencast.name+":"+x.opencast.password))),i={Authorization:"Basic ".concat(c)}),l=Object(o.a)(Object(o.a)({method:a?"POST":"GET"},r),{},{headers:Object(o.a)(Object(o.a)(Object(o.a)({},s),r.headers),i)}),a&&(l.body=JSON.stringify(a)),e.prev=6,e.next=9,window.fetch(t,l);case 9:return b=e.sent,e.next=12,b.text();case 12:if(d=e.sent,!b.url.includes("login.html")){e.next=15;break}throw new Error("Got redirected to login page, authentification failed.");case 15:if(!b.ok){e.next=18;break}return u=d.length?JSON.parse(d):"",e.abrupt("return",u);case 18:throw new Error(b.statusText);case 21:return e.prev=21,e.t0=e.catch(6),e.abrupt("return",Promise.reject(e.t0.message?e.t0.message:u));case 24:case"end":return e.stop()}}),e,null,[[6,21]])})))).apply(this,arguments)}ee.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ee(e,Object(o.a)(Object(o.a)({},t),{},{method:"GET"}))},ee.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ee(e,Object(o.a)(Object(o.a)({},n),{},{body:t}))};var ne=function(e,t){var n=Math.pow(10,t);return Math.round((e+Number.EPSILON)*n)/n},ae=function(e){var t=new Date(e||0).toISOString().substr(11,2),n=new Date(e||0).toISOString().substr(14,2),a=new Date(e||0).toISOString().substr(17,2),r=[];return parseInt(t)>0&&r.push(t+" hours, "),(parseInt(n)>0||parseInt(t)>0)&&r.push(n+" minutes, "),r.push(a+" seconds"),r.join("")};var re={isPlaying:!1,isPlayPreview:!0,currentlyAt:0,segments:[{id:Object(j.d)(),start:0,end:1,deleted:!1}],tracks:[],activeSegmentIndex:0,selectedWorkflowIndex:0,previewTriggered:!1,aspectRatios:[],videoURLs:[],videoCount:0,duration:0,title:"",presenters:[],workflows:[],status:"idle",error:void 0},se=Object(j.b)("video/fetchVideoInformation",Object(P.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.mediaPackageId){e.next=2;break}throw new Error("Missing mediaPackageId");case 2:return e.next=4,ee.get("".concat(x.opencast.url,"/editor/").concat(x.mediaPackageId,"/edit.json"));case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))),ie=function(e,t){e.currentlyAt=ne(t,0),e.currentlyAt<0&&(e.currentlyAt=0),0!==e.duration&&e.duration<e.currentlyAt&&(e.currentlyAt=e.duration),oe(e),de(e)},ce=Object(j.c)({name:"videoState",initialState:re,reducers:{setIsPlaying:function(e,t){e.isPlaying=t.payload},setIsPlayPreview:function(e,t){e.isPlayPreview=t.payload},setPreviewTriggered:function(e,t){e.previewTriggered=t.payload},setCurrentlyAt:function(e,t){ie(e,t.payload)},setCurrentlyAtInSeconds:function(e,t){ie(e,ne(1e3*t.payload,0))},addSegment:function(e,t){e.segments.push(t.payload)},setAspectRatio:function(e,t){e.aspectRatios[t.payload.dataKey]={width:t.payload.width,height:t.payload.height}},cut:function(e){if(e.segments[e.activeSegmentIndex].start===e.currentlyAt||e.segments[e.activeSegmentIndex].end===e.currentlyAt)return e;var t={id:Object(j.d)(),start:e.segments[e.activeSegmentIndex].start,end:e.currentlyAt,deleted:e.segments[e.activeSegmentIndex].deleted},n={id:Object(j.d)(),start:e.currentlyAt,end:e.segments[e.activeSegmentIndex].end,deleted:e.segments[e.activeSegmentIndex].deleted};e.segments.splice(e.activeSegmentIndex,1,t,n)},markAsDeletedOrAlive:function(e){e.segments[e.activeSegmentIndex].deleted=!e.segments[e.activeSegmentIndex].deleted},setSelectedWorkflowIndex:function(e,t){e.selectedWorkflowIndex=t.payload},mergeLeft:function(e){ue(e,e.activeSegmentIndex,e.activeSegmentIndex-1)},mergeRight:function(e){ue(e,e.activeSegmentIndex,e.activeSegmentIndex+1)}},extraReducers:function(e){e.addCase(se.pending,(function(e,t){e.status="loading"})),e.addCase(se.fulfilled,(function(e,t){e.status="success",e.videoURLs=t.payload.tracks.reduce((function(e,t){return e.push(t.uri),e}),[]),e.videoCount=e.videoURLs.length,e.duration=t.payload.duration,e.title=t.payload.title,e.presenters=[],e.segments=le(t.payload.segments,t.payload.duration),e.tracks=t.payload.tracks,e.workflows=t.payload.workflows.sort((function(e,t){return e.displayOrder>t.displayOrder?1:e.displayOrder<t.displayOrder?-1:0})),e.aspectRatios=new Array(e.videoCount)})),e.addCase(se.rejected,(function(e,t){e.status="failed",e.error=t.error.message}))}}),oe=function(e){e.activeSegmentIndex=e.segments.findIndex((function(t){return t.start<=e.currentlyAt&&t.end>=e.currentlyAt})),e.activeSegmentIndex<0&&(e.activeSegmentIndex=0)},le=function(e,t){var n=[];return 0===e.length&&n.push({id:Object(j.d)(),start:0,end:t,deleted:!1}),e.forEach((function(e){n.push({id:Object(j.d)(),start:e.start,end:e.end,deleted:e.deleted})})),n},ue=function(e,t,n){n<0||n>e.segments.length-1||(e.segments[t].start=Math.min(e.segments[t].start,e.segments[n].start),e.segments[t].end=Math.max(e.segments[t].end,e.segments[n].end),e.segments.splice(n,1),oe(e))},de=function(e){if(e.isPlaying&&e.segments[e.activeSegmentIndex].deleted&&e.isPlayPreview){for(var t=e.segments[e.activeSegmentIndex].end,n=e.activeSegmentIndex;n<e.segments.length&&e.segments[n].deleted;)t=e.segments[n].end,n++;e.currentlyAt=t,e.previewTriggered=!0}},be=ce.actions,je=be.setIsPlaying,fe=be.setIsPlayPreview,pe=be.setCurrentlyAt,xe=be.setCurrentlyAtInSeconds,ge=(be.addSegment,be.setAspectRatio),he=be.cut,me=be.markAsDeletedOrAlive,ve=be.setSelectedWorkflowIndex,Oe=be.mergeLeft,ye=be.mergeRight,we=be.setPreviewTriggered,Se=function(e){return e.videoState.isPlaying},ke=function(e){return e.videoState.isPlayPreview},Ie=function(e){return e.videoState.previewTriggered},Ce=function(e){return e.videoState.currentlyAt},Ee=function(e){return e.videoState.currentlyAt/1e3},Ae=function(e){return e.videoState.segments},Ne=function(e){return e.videoState.activeSegmentIndex},Pe=function(e){return!e.videoState.segments[e.videoState.activeSegmentIndex].deleted},De=function(e){return e.videoState.selectedWorkflowIndex},Te=function(e){return e.videoState.videoURLs},Le=function(e){return e.videoState.videoCount},Re=function(e){return e.videoState.duration},Ge=function(e){return e.videoState.duration/1e3},Me=function(e){return e.videoState.title},We=function(e){return e.videoState.presenters},He=function(e){return e.videoState.tracks},Be=function(e){return e.videoState.workflows},Ue=function(e){return function(e){var t=Math.min.apply(Math,e.map((function(e){return e.height}))),n=Math.min.apply(Math,e.map((function(e){return e.width})));return n*=e.length,Math.min(t/n*100,28.125)}(e.videoState.aspectRatios)},Ve=ce.reducer,Fe=function(e){var t=e.iconName,n=e.stateName,r=Object(b.b)(),s=Object(b.c)(v),i=function(){r(m(n)),n===a.finish&&r(k(0)),r(je(!1))},c=Object(l.css)(Object(o.a)(Object(o.a)({width:"100%",height:"100px"},s===n&&{backgroundColor:"#DDD"}),{},{flexDirection:"column"}),"","");return Object(l.jsx)("li",{css:[q,c,"",""],role:"menuitem",tabIndex:0,onClick:i,onKeyDown:function(e){"Enter"===e.key&&i()}},Object(l.jsx)(u.a,{icon:t,size:"2x"}),Object(l.jsx)("div",null,n))},ze=function(){var e=Object(l.css)({borderRight:"1px solid #BBB",width:"100px",display:"flex",flexDirection:"column",flexShrink:0,alignItems:"center",padding:"20px",gap:"30px"},"","");return Object(l.jsx)("nav",{css:e,title:"Main Menu",role:"navigation","aria-label":"Main Navigation"},Object(l.jsx)(Fe,{iconName:d.h,stateName:a.cutting}),x.metadata.show&&Object(l.jsx)(Fe,{iconName:d.i,stateName:a.metadata}),x.thumbnail.show&&Object(l.jsx)(Fe,{iconName:d.k,stateName:a.thumbnail}),Object(l.jsx)(Fe,{iconName:d.n,stateName:a.finish}))},Ke=n(33),Ye=n(126),_e=n.n(Ye);var qe={name:"14fvduy",styles:"position:absolute;top:0;left:0"},Je=function(e){var t=e.dataKey,n=e.url,a=e.isPrimary,i=Object(b.b)(),c=Object(b.c)(Se),u=Object(b.c)(Ee),d=Object(b.c)(Ge),j=Object(b.c)(Ie),f=Object(b.c)(Ue),p=Object(r.useRef)(null),x=Object(r.useState)(!1),g=Object(Ke.a)(x,2),h=g[0],m=g[1],v=Object(r.useState)(!1),O=Object(Ke.a)(v,2),y=O[0],w=O[1],S=function(e){a&&ne(u,3)!==ne(e.playedSeconds,3)&&i(xe(e.playedSeconds))},k=function(){if(m(!0),p.current&&p.current.getInternalPlayer()){var e=p.current.getInternalPlayer().videoWidth,n=p.current.getInternalPlayer().videoHeight;i(ge({dataKey:t,width:e,height:n}))}},I=function(){a&&(i(je(!1)),i(xe(d)))};Object(r.useEffect)((function(){!c&&p.current&&h&&p.current.seekTo(u,"seconds"),j&&p.current&&h&&(p.current.seekTo(u,"seconds"),i(we(!1)))}));var C=function(e){w(!0)},E={file:{attributes:{tabIndex:"-1"}}},A=Object(l.css)(Object(o.a)(Object(o.a)({},!y&&{display:"none"}),{},{borderColor:"red",borderStyle:"dashed",fontWeight:"bold",padding:"10px"}),"",""),N=Object(l.css)({position:"relative",width:"100%",paddingTop:f+"%"},"",""),P=qe;return Object(l.jsx)(s.a.Fragment,null,y?Object(l.jsx)("div",{css:A,title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"An error has occured loading this video. ")):Object(l.jsx)("div",{css:N,title:"playerWrapper"},Object(l.jsx)(_e.a,{url:n,css:P,ref:p,width:"100%",height:"100%",playing:c,muted:!a,onProgress:S,progressInterval:100,onReady:k,onEnded:I,onError:C,tabIndex:-1,config:E,disablePictureInPicture:!0})))},Xe={name:"1uvkv0q",styles:"width:100%;display:flex;justify-content:left"},$e={name:"1x5loa1",styles:"width:100%;display:flex;justify-content:right"},Qe={name:"1uao5ta",styles:"display:flex;flex-direction:row;justify-content:center;align-items:center;width:100%;padding:20px;gap:50px"},Ze=function(){var e=Qe,t=$e,n=Xe;return Object(l.jsx)("div",{css:e,title:"Video Controls"},Object(l.jsx)("div",{css:t},Object(l.jsx)(at,null)),Object(l.jsx)(rt,null),Object(l.jsx)("div",{css:n},Object(l.jsx)(ct,null)))},et={name:"1gnq0uh",styles:"cursor:pointer;transition-duration:0.3s;transition-property:transform;&:hover{transform:scale(1.05);}"},tt={name:"1pd6nwc",styles:"cursor:pointer;display:flex;gap:10px;justify-content:center;align-items:center"},nt={name:"iaqz3e",styles:"display:inline-block;flex-wrap:nowrap"},at=function(){var e=Object(b.b)(),t=Object(b.c)(ke),n=function(){e(fe(!t))},a=tt,r=et;return Object(l.jsx)("div",{css:a,title:"Skips deleted segments when playing the video. Currently "+(t?"on":"off"),role:"switch","aria-checked":t,tabIndex:0,"aria-hidden":!1,"aria-label":"Enable or disable preview mode.",onClick:n,onKeyDown:function(e){" "===e.key&&n()}},Object(l.jsx)("div",{css:nt},"Preview Mode"),Object(l.jsx)(u.a,{css:r,icon:t?d.t:d.s,size:"1x"}))},rt=function(){var e=Object(b.b)(),t=Object(b.c)(Se),n=function(){e(je(!t))};return Object(l.jsx)(u.a,{css:[q,"justify-self:center;",""],icon:t?d.j:d.l,size:"2x",title:"Play Button",role:"button","aria-pressed":t,tabIndex:0,"aria-hidden":!1,"aria-label":"Play Button",onClick:n,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||n()}})},st={name:"1nvb49c",styles:"display:flex;flex-direction:row;gap:5px"},it={name:"147w8p8",styles:"display:inline-block;width:100px"},ct=function(){var e=Object(b.c)(Ce),t=Object(b.c)(Re);return Object(l.jsx)("div",{css:st},Object(l.jsx)("time",{css:it,title:"Playback time and duration",tabIndex:0,role:"timer","aria-label":"Current time: "+ae(e)},new Date(e||0).toISOString().substr(11,12))," / ",Object(l.jsx)("div",{tabIndex:0,"aria-label":"Duration: "+ae(t)},new Date(t||0).toISOString().substr(11,12)))},ot={name:"18oixho",styles:"font-weight:bold;font-size:24px;vertical-align:-2.5px"},lt={name:"akya17",styles:"display:inline-block;padding:15px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:500px"},ut={name:"11g4mt0",styles:"font-size:16px"},dt=function(){var e,t=Object(b.c)(Me),n=Object(b.c)(We),a=lt,r=ot;return n&&n.length&&(e=Object(l.jsx)("div",{css:a,title:"Video Presenters"},"by ",n.join(", "))),Object(l.jsx)("div",{title:"Video Area Header",css:ut},Object(l.jsx)("div",{css:[a,r,"",""],title:"Video Title"},t),e)},bt=function(){var e=Object(b.b)(),t=Object(b.c)(Te),n=Object(b.c)(Le),a=Object(b.c)((function(e){return e.videoState.status})),s=Object(b.c)((function(e){return e.videoState.error}));Object(r.useEffect)((function(){"idle"===a&&e(se())}),[a,e]);for(var i=[],c=0;c<n;c++)i.push(Object(l.jsx)(Je,{key:c,dataKey:c,url:t[c],isPrimary:0===c}));var o=Object(l.css)({display:"flex",width:"auto",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"0px",borderBottom:"1px solid #BBB"},"",""),u=Object(l.css)({display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%"},"","");return Object(l.jsx)("div",{css:o,title:"Video Area"},Object(l.jsx)("div",{css:Q("failed"===a),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"A problem occured during communication with Opencast."),Object(l.jsx)("br",null),s?"Details: "+s:"No error details are available.",Object(l.jsx)("br",null)),Object(l.jsx)(dt,null),Object(l.jsx)("div",{css:u,title:"Video Player Area"},i),Object(l.jsx)(Ze,null))},jt=n(127),ft=n.n(jt),pt=n(128);function xt(e){var t=this;this.audioContext=new AudioContext,this.oCanvas=document.createElement("canvas"),this.buffer={},this.WIDTH=0,this.HEIGHT=0,this.channelData=[],this.waveformImage="",this.audioBuffer=null,this.aveRMS=0,this.peakRMS=0,this.numberSamples=1e5,this.waveformType="img",this.drawWaveform=this.drawCanvasWaveform,e.width&&e.height&&this.setDimensions(e.width,e.height),e.samples&&(this.numberSamples=e.samples),e.type&&"svg"===e.type&&(this.waveformType="svg",this.drawWaveform=this.delegateToWorker,this.worker=null),e.media&&this.generateWaveform(e.media).then((function(){t.getAudioData(),t.drawWaveform(),"svg"!==t.waveformType&&n.forEach((function(e){e(t.waveformImage||t.svgPath,t.waveformType)}))})).catch((function(e){return console.log(e)}));var n=[];Object.defineProperty(this,"oncomplete",{get:function(){return n},set:function(e,t){if("function"==typeof e){if(this.waveformImage||this.svgPath)return void e(this.waveformImage||this.svgPath,this.svgLength);n.push(e)}}})}xt.prototype={constructor:xt,setDimensions:function(e,t){this.oCanvas.width=e,this.WIDTH=e,this.oCanvas.height=t,this.HEIGHT=t,this.ocCtx=this.oCanvas.getContext("2d")},decodeAudioData:function(e){var t=this;return new Promise((function(n,a){new Promise((function(t,n){if(e instanceof ArrayBuffer)t(e);else if(e instanceof Blob){var a=new FileReader;a.onload=function(){t(a.result)},a.readAsArrayBuffer(e)}})).then((function(e){t.audioContext.decodeAudioData(e).then((function(e){t.buffer=e,n()})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}))},getAudioData:function(e){e=e||this.buffer,this.channelData=this.dropSamples(e.getChannelData(0),this.numberSamples)},drawCanvasWaveform:function(e){var t=this;e=e||1,this.ocCtx.fillStyle="#FFFFFF00",this.ocCtx.fillRect(0,0,this.WIDTH,this.HEIGHT),this.ocCtx.lineWidth=1,this.ocCtx.strokeStyle="black";var n=1*this.WIDTH/this.channelData.length,a=0;this.ocCtx.beginPath(),this.ocCtx.moveTo(a,this.channelData[0]*this.HEIGHT/128/2),this.channelData.forEach((function(r){var s=r*e,i=t.HEIGHT*(1+s)/2;t.ocCtx.lineTo(a,i),t.aveRMS+=r*r,t.peakRMS=Math.max(r*r,t.peakRMS),a+=n})),this.ocCtx.lineTo(this.WIDTH,this.HEIGHT/2),this.ocCtx.stroke(),this.aveRMS=Math.sqrt(this.aveRMS/this.channelData.length),this.aveDBs=20*Math.log(this.aveRMS)/Math.log(10),this.waveformImage=this.oCanvas.toDataURL()},dropSamples:function(e,t){var n=Math.max(parseInt(e.length/t),1);return e.filter((function(e,t){return t%n===0}))},generateWaveform:function(e){return this.decodeAudioData(e)},delegateToWorker:function(){this.worker||(this.worker=new Worker("../util/svgworker.js"),this.worker.addEventListener("message",this.workerCommunication.bind(this),!1),this.worker.postMessage(this.channelData))},workerCommunication:function(e){switch(e.data.type){case"path":this.setSVGpath(e.data.path,e.data.length),this.worker.removeEventListener("message",this.workerCommunication.bind(this),!1),this.worker.terminate(),this.worker=null}},setSVGpath:function(e,t){var n=this;this.svgPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.svgLength=t,this.svgPath.setAttribute("d",e),this.svgPath.setAttribute("vector-effect","non-scaling-stroke"),this.svgPath.setAttribute("stroke-width","0.5px"),this.oncomplete.forEach((function(e){return e(n.svgPath,n.svgLength)}))}};var gt={name:"10kp0sj",styles:"height:230px"},ht={name:"1iopd98",styles:"width:0;height:0;border-left:7px solid transparent;border-right:7px solid transparent;border-top:7px solid black"},mt={name:"n4tiqn",styles:"width:0;height:0;border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:7px solid black"},vt={name:"9n2iv6",styles:"transform:scaleY(1.5) rotate(90deg);padding:5px"},Ot=function(e){var t=e.timelineWidth,n=Object(b.b)(),a=Object(b.c)(Se),i=Object(b.c)(Ce),c=Object(b.c)(Re),o=Object(b.c)(Ne),j=Object(b.c)(Ae),f=Object(r.useState)({x:0,y:0}),p=Object(Ke.a)(f,2),x=p[0],g=p[1],h=Object(r.useState)(!1),m=Object(Ke.a)(h,2),v=m[0],O=m[1],y=Object(r.useState)(!1),w=Object(Ke.a)(y,2),S=w[0],k=w[1],I=Object(r.useState)(1e3),C=Object(Ke.a)(I,2),E=C[0],A=C[1],N=Object(r.useRef)(0),P=s.a.useRef(null);Object(r.useEffect)((function(){i!==N.current&&(D(),N.current=i)})),Object(r.useEffect)((function(){i&&c&&g({x:i/c*t,y:0})}),[t]);var D=function(){var e=x.y;g({x:i/c*t,y:e})},T=Object(l.css)({backgroundColor:"black",height:"250px",width:"1px",position:"absolute",zIndex:2,boxShadow:"0 0 10px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center"},"",""),L=Object(l.css)({backgroundColor:"rgba(255, 255, 255, 1)",borderRadius:"10px",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 0 10px rgba(0, 0, 0, 0.3)",cursor:v?"grabbing":"grab",transitionDuration:"0.3s",transitionProperty:"transform","&:hover":{transform:"scale(1.1)"},"&:active":{transform:"scale(0.9)"}},"",""),R=vt,G=mt,M=ht;return Object(l.jsx)(ft.a,{onStart:function(){O(!0),a?(k(!0),n(je(!1))):k(!1)},onStop:function(e,a){var r=a.x,s=a.y;g({x:r,y:s}),n(pe(r/t*c)),O(!1),S&&n(je(!0))},axis:"x",bounds:"parent",position:x,nodeRef:P},Object(l.jsx)("div",{ref:P,css:T,title:"Scrubber"},Object(l.jsx)("div",{css:M}),Object(l.jsx)("div",{css:L,title:"dragHandle","aria-grabbed":v,"aria-label":"Scrubber. "+ae(i)+". Active segment: "+o+". "+(j[o].deleted?"Deleted.":"Alive.")+". Controls: Alt+j and Alt+k to move the scrubber. Alt+i and Alt+k to increase/decrase the move delta.",tabIndex:0,onKeyDown:function(e){if(e.altKey)switch(e.key){case"j":n(pe(Math.max(i-E,0)));break;case"l":n(pe(Math.min(i+E,c)));break;case"i":A(Math.min(10*E,1e6));break;case"k":A(Math.max(E/10,1))}}},Object(l.jsx)(u.a,{css:R,icon:d.a,size:"1x"})),Object(l.jsx)("div",{css:G})))},yt=function(e){e.timelineWidth;var t=Object(b.c)(Ae),n=Object(b.c)(Re),a=Object(b.c)(Ne),r=Object(l.css)({display:"flex",flexDirection:"row",paddingTop:"10px"},"","");return Object(l.jsx)("div",{css:r,title:"Segments"},t.map((function(e,t){return Object(l.jsx)("div",{key:e.id,title:"Segment "+t,"aria-label":"Segment "+t+". "+(e.deleted?"Deleted.":"Alive.")+" Start: "+ae(e.start)+". End: "+ae(e.end)+".",tabIndex:0,css:Object(l.css)({background:(r=e.deleted,s=a===t,r||s?r&&!s?"repeating-linear-gradient(\n                -45deg,\n                rgba(255, 45, 45, 0.4),\n                rgba(255, 45, 45, 0.4) 10px,\n                rgba(255, 0, 0, 0.4) 10px,\n                rgba(255, 0, 0, 0.4) 20px);":!r&&s?"rgba(0, 0, 200, 0.4)":r&&s?"repeating-linear-gradient(\n                -45deg,\n                rgba(200, 45, 45, 0.4),\n                rgba(200, 45, 45, 0.4) 10px,\n                rgba(200, 0, 0, 0.4) 10px,\n                rgba(200, 0, 0, 0.4) 20px);":void 0:"rgba(0, 0, 255, 0.4)"),borderRadius:"5px",borderStyle:a===t?"dashed":"solid",borderColor:"white",borderWidth:"1px",boxSizing:"border-box",width:(e.end-e.start)/n*100+"%",height:"230px",zIndex:1},"","")});var r,s})))},wt={name:"mvrlf6",styles:"min-height:0"},St=function(){var e=Object(b.c)(Te),t=Object(b.c)((function(e){return e.videoState.status})),n=Object(r.useState)([]),a=Object(Ke.a)(n,2),i=a[0],c=a[1],j=Object(l.css)(Object(o.a)(Object(o.a)({display:"flex",flexDirection:"column",position:"absolute",justifyContent:"center"},i.length<=0&&{alignItems:"center"}),{},{width:"100%",height:"230px",paddingTop:"10px"}),"","");Object(r.useEffect)((function(){if("success"===t){var n=[],a=0;[e[0]].forEach((function(e,t,r){var s=null,i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){s=i.response,new xt({type:"img",width:"2000",height:"230",samples:1e5,media:new File([s],s)}).oncomplete=function(e,t){n.push(e),++a===r.length&&c(n)}},i.send()}))}}),[t,e]);return Object(l.jsx)("div",{css:j,title:"WaveformDisplayTest"},i.length>0?i.map((function(e,t){return Object(l.jsx)("img",{key:t,alt:"Waveform",src:e||"",css:wt})})):Object(l.jsx)(s.a.Fragment,null,Object(l.jsx)(u.a,{icon:d.o,spin:!0,size:"3x"}),Object(l.jsx)("div",null,"Generating Waveform")))},kt=function(){var e=Object(pt.a)(),t=e.ref,n=e.width,a=void 0===n?1:n,r=Object(l.css)({position:"relative",height:"250px",width:"100%"},"","");return Object(l.jsx)("div",{ref:t,css:r,title:"Timeline"},Object(l.jsx)(Ot,{timelineWidth:a}),Object(l.jsx)("div",{css:gt},Object(l.jsx)(St,null),Object(l.jsx)(yt,{timelineWidth:a})))},It={padding:"16px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.3)"},Ct=function(e){var t=e.iconName,n=e.actionName,a=e.action,r=e.tooltip,s=e.ariaLabelText,i=Object(b.b)(),c=function(){a&&i(a())};return Object(l.jsx)("div",{css:[q,It,"",""],title:r,role:"button",tabIndex:0,"aria-label":s,onClick:c,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||c()}},Object(l.jsx)(u.a,{icon:t,size:"1x"}),Object(l.jsx)("span",null,n))},Et=function(){var e=Object(b.b)(),t=Object(b.c)(Pe);return Object(l.jsx)("div",{css:[q,It,"",""],title:"Mark or unmark the segment at the current position as to be deleted.",role:"button",tabIndex:0,"aria-label":"Delete and Restore. Mark or unmark the segment at the current position as to be deleted.",onClick:function(){return e(me())}},Object(l.jsx)(u.a,{icon:t?d.v:d.w,size:"1x"}),Object(l.jsx)("div",null,t?"Delete":"Restore"))},At=function(){var e=Object(l.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"30px"},"",""),t=Object(l.css)({display:"flex",flexDirection:"row",gap:"30px"},"","");return Object(l.jsx)("div",{css:e},Object(l.jsx)("div",{css:t},Object(l.jsx)(Ct,{iconName:d.e,actionName:"Cut",action:he,tooltip:"Split the segment at the current scrubber position",ariaLabelText:"Cut. Split the segment at the current scrubber position"}),Object(l.jsx)(Et,null),Object(l.jsx)(Ct,{iconName:d.p,actionName:"Merge Left",action:Oe,tooltip:"Combine the currently active segment with the segment to its left",ariaLabelText:"Merge Left. Combine the currently active segment with the segment to its left"}),Object(l.jsx)(Ct,{iconName:d.q,actionName:"Merge Right",action:ye,tooltip:"Combine the currently active segment with the segment to its right",ariaLabelText:"Merge Right. Combine the currently active segment with the segment to its right"})),Object(l.jsx)("div",{css:t}))},Nt=n(57),Pt={catalogs:[],status:"idle",error:void 0,postStatus:"idle",postError:void 0},Dt=Object(j.b)("metadata/fetchMetadata",Object(P.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.mediaPackageId){e.next=2;break}throw new Error("Missing mediaPackageId");case 2:return e.next=4,ee.get("".concat(x.opencast.url,"/editor/").concat(x.mediaPackageId,"/metadata.json"));case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))),Tt=Object(j.b)("metadata/postMetadata",function(){var e=Object(P.a)(N.a.mark((function e(t,n){var a,r,s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState,x.mediaPackageId){e.next=3;break}throw new Error("Missing mediaPackageId");case 3:return r=a(),e.next=6,ee.post("".concat(x.opencast.url,"/editor/").concat(x.mediaPackageId,"/metadata.json"),r.metadataState.catalogs);case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Lt=Object(j.c)({name:"metadataState",initialState:Pt,reducers:{setFieldValue:function(e,t){e.catalogs[t.payload.catalogIndex].fields[t.payload.fieldIndex].value=t.payload.value}},extraReducers:function(e){e.addCase(Dt.pending,(function(e,t){e.status="loading"})),e.addCase(Dt.fulfilled,(function(e,t){e.catalogs=t.payload,e.status="success"})),e.addCase(Dt.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),e.addCase(Tt.pending,(function(e,t){e.postStatus="loading"})),e.addCase(Tt.fulfilled,(function(e,t){e.postStatus="success"})),e.addCase(Tt.rejected,(function(e,t){e.postStatus="failed",e.postError=t.error.message}))}}),Rt=Lt.actions.setFieldValue,Gt=function(e){return e.metadataState.catalogs},Mt=function(e){return e.metadataState.status},Wt=function(e){return e.metadataState.error},Ht=function(e){return e.metadataState.postStatus},Bt=function(e){return e.metadataState.postError},Ut=Lt.reducer,Vt=n(24),Ft=n(149),zt=n(129),Kt=n(98),Yt=n(69);var _t={name:"1hieqdo",styles:"background:snow;border:1px solid #ccc;&[disabled]{opacity:0.6;cursor:not-allowed;}"},qt={name:"kdbv2",styles:"display:flex;flex-flow:row nowrap;justify-content:center;margin-top:25px"},Jt={name:"1ajfugh",styles:"line-height:32px;margin-left:10px;color:#800;font-weight:bold"},Xt={name:"pbjnao",styles:"align-self:center;width:110px;font-size:1em;line-height:32px"},$t={name:"1q4to1d",styles:"display:flex;flex-flow:row nowrap;line-height:2em;margin:10px"},Qt={name:"1yjx7km",styles:"padding:20px"},Zt=function(){var e=Object(b.b)(),t=Object(b.c)(Gt),n=Object(b.c)(Mt),a=Object(b.c)(Wt),s=Object(b.c)(Ht),i=Object(b.c)(Bt);Object(r.useEffect)((function(){"idle"===n&&e(Dt())}),[n,e]);var c=Qt,u=$t,d=Xt,j=function(e){return Object(l.css)(Object(o.a)({flex:"1",fontSize:"1em",marginLeft:"15px",borderRadius:"5px",backgroundColor:"snow",boxShadow:e?"0 0 0px rgba(0, 0, 0, 0.3)":"0 0 1px rgba(0, 0, 0, 0.3)"},e&&{color:"grey"}),"","")},f=function(e){return Object(l.css)({padding:"10px 10px",border:e?"0px solid #ccc":"1px solid #ccc"},"","")},p={control:function(e){return Object(o.a)(Object(o.a)({},e),{},{background:"snow"})},menu:function(e){return Object(o.a)(Object(o.a)({},e),{},{background:"snow",marginTop:0})}},x=Jt,g=qt,h=Object(l.css)({borderRadius:"10px",cursor:"pointer",transitionDuration:"0.3s",transitionProperty:"transform","&:hover:enabled":{transform:"scale(1.1)"},"&:focus:enabled":{transform:"scale(1.1)"},"&:active:enabled":{transform:"scale(0.9)"},display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",textAlign:"center"},"",""),m=_t,v={"EVENTS.EVENTS.DETAILS.CATALOG.EPISODE":"Episode Metadata",test:"test",labels:{title:"Title",subject:"Subject",description:"Description",language:"Language",rightsHolder:"Rights",license:"License",isPartOf:"Series",creator:"Presenter(s)",contributor:"Contributor(s)",startDate:"Start date",duration:"Duration",location:"Location",source:"Source",created:"Created",publisher:"Publisher",identifier:"UID"},language:{"LANGUAGES.SLOVENIAN":"Slovenian","LANGUAGES.PORTUGESE":"Portugese","LANGUAGES.ROMANSH":"Romansh","LANGUAGES.ARABIC":"Arabic","LANGUAGES.POLISH":"Polish","LANGUAGES.ITALIAN":"Italian","LANGUAGES.CHINESE":"Chinese","LANGUAGES.FINNISH":"Finnish","LANGUAGES.DANISH":"Danish","LANGUAGES.UKRAINIAN":"Ukrainian","LANGUAGES.FRENCH":"French","LANGUAGES.SPANISH":"Spanish","LANGUAGES.GERMAN_CH":"Swiss German","LANGUAGES.NORWEGIAN":"Norwegian","LANGUAGES.RUSSIAN":"Russian","LANGUAGES.JAPANESE":"Japanese","LANGUAGES.DUTCH":"Dutch","LANGUAGES.TURKISH":"Turkish","LANGUAGES.HINDI":"Hindi","LANGUAGES.SWEDISH":"Swedish","LANGUAGES.ENGLISH":"English","LANGUAGES.GERMAN":"German"},license:{"EVENTS.LICENSE.CC0":"CC0","EVENTS.LICENSE.CCBYND":"CC-BY-ND","EVENTS.LICENSE.CCBYNCND":"CC-BY-NC-ND","EVENTS.LICENSE.CCBYNCSA":"CC-BY-NC-SA","EVENTS.LICENSE.ALLRIGHTS":"All rights reserved","EVENTS.LICENSE.CCBYSA":"CC-BY-SA","EVENTS.LICENSE.CCBYNC":"CC-BY-NC","EVENTS.LICENSE.CCBY":"CC-BY"}},O=function e(t,n,a){return Array.isArray(n)&&n.forEach((function(n){a.push(e(t,n,a))})),null===t||void 0===t?void 0:t.find((function(e){return e.submitValue===n}))},y=function(e){var t={};return e.forEach((function(e,n){t["catalog"+n]={},e.fields.forEach((function(e){if(t["catalog"+n][e.id]=e.value,e.collection){var a=E(e),r=e.value;if(Array.isArray(r)){var s=[];O(a,e.value,s),r=s}else r=null===a||void 0===a?void 0:a.find((function(e){return e.submitValue===r}));t["catalog"+n][e.id]=r}}))})),t},w=function(e){return e?void 0:"Required"},S=function(e){return/^[0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/.test(e)?void 0:"Format must be HH:MM:SS"},k=function(e){return e.required?w:"duration"===e.id?S:void 0},I=function e(t,n){var a=n;return Array.isArray(n)&&(a=[],n.forEach((function(t){a.push(e(null,t))}))),"object"===typeof n&&null!==n&&n.hasOwnProperty("submitValue")?a=n.submitValue:"object"===typeof n&&null!==n&&n.__isNew__&&(a=n.value),!t||Array.isArray(n)||"creator"!==t.id&&"contributor"!==t.id||(a=[a]),t&&"date"===t.type&&"[object Date]"===Object.prototype.toString.call(a)&&(a=a.toJSON()),a},C=function(n){Object.keys(n).forEach((function(a){var r=parseInt(a.replace("catalog",""));Object.keys(n[a]).forEach((function(s){for(var i=0;i<t[r].fields.length;i++)if(t[r].fields[i].id===s){e(Rt({catalogIndex:r,fieldIndex:i,value:I(t[r].fields[i],n[a][s])}));break}})),e(Tt())}))},E=function(e){if(e.collection){var t=[{value:"",label:"No value",submitValue:""}];return Object.entries(e.collection).forEach((function(n){var a=Object(Ke.a)(n,2),r=a[0],s=a[1],i=null;v[e.id]&&(i=v[e.id][r]),"isPartOf"===e.id&&(i=r),t.push({value:r,label:i||s,submitValue:s})})),t}return null},A=function(e,t,n){return Object(l.jsx)(Vt.a,{key:n,name:"catalog"+t+"."+e.id,validate:k(e)},(function(t){var n=t.input,a=t.meta;return Object(l.jsx)("div",{css:u},Object(l.jsx)("label",{css:d},v.labels[e.id]),function(e,t){return e.collection?Array.isArray(e.value)?Object(l.jsx)(zt.a,Object(Nt.a)({},t,{isMulti:!0,isClearable:!0,readOnly:e.readOnly,options:E(e),styles:p,css:j(e.readOnly)})):Object(l.jsx)(Ft.a,Object(Nt.a)({},t,{readOnly:e.readOnly,options:E(e),styles:p,css:j(e.readOnly)})):"date"===e.type?Object(l.jsx)("div",{css:[j(e.readOnly),(n=e.readOnly,Object(l.css)({padding:"5px 10px",border:n?"0px solid #ccc":"1px solid #ccc"},"","")),"",""]},Object(l.jsx)(Kt.a,Object(Nt.a)({},t,{name:e.id,format:"yyyy/MM/dd HH:mm",disabled:e.readOnly,dateFunsUtils:Yt.a,showError:Kt.b}))):Object(l.jsx)("input",Object(Nt.a)({},t,{readOnly:e.readOnly,css:[j(e.readOnly),f(e.readOnly),"",""]}));var n}(e,n),a.error&&a.touched&&Object(l.jsx)("span",{css:x},a.error))}))};return Object(l.jsx)(Vt.b,{onSubmit:C,initialValues:y(t),render:function(e){var r=e.handleSubmit,o=(e.form,e.submitting),u=e.pristine;return e.values,Object(l.jsx)("form",{onSubmit:r,css:c},Object(l.jsx)("div",{css:Q("failed"===n),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"A problem occured during communication with Opencast."),Object(l.jsx)("br",null),a?"Details: "+a:"No error details are available.",Object(l.jsx)("br",null)),t.map((function(e,t){return function(e,t){return Object(l.jsx)("div",{key:t},Object(l.jsx)("h2",null,v[e.title]),e.fields.map((function(e,n){return A(e,t,n)})))}(e,t)})),Object(l.jsx)("div",{title:"buttons",css:g},Object(l.jsx)("button",{css:[h,J,m,"",""],type:"submit",disabled:o||u},"Save")),Object(l.jsx)("div",{css:Q("failed"===s),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"A problem occured during communication with Opencast. ",Object(l.jsx)("br",null),"Changes could not be saved to Opencast."),Object(l.jsx)("br",null),i?"Details: "+i:"No error details are available.",Object(l.jsx)("br",null)))}})},en=function(e){var t=e.iconName,n=e.stateName,a=Object(b.b)(),r=function(){a(S(n)),a(k(1))},s=Object(l.css)({width:"250px",height:"220px",flexDirection:"column",fontSize:"x-large",gap:"30px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.3)"},"","");return Object(l.jsx)("div",{css:[q,s,"",""],role:"button",tabIndex:0,onClick:r,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||r()}},Object(l.jsx)(u.a,{icon:t,size:"2x"}),Object(l.jsx)("div",null,n))},tn=function(){var e=Object(l.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",flexWrap:"wrap",gap:"30px"},"","");return Object(l.jsx)("div",{css:e,title:"Finish Menu"},Object(l.jsx)(en,{iconName:d.m,stateName:"Save changes"}),Object(l.jsx)(en,{iconName:d.g,stateName:"Start processing"}),Object(l.jsx)(en,{iconName:d.r,stateName:"Discard changes"}))},nn={status:"idle",error:void 0},an=Object(j.b)("video/postVideoInformation",function(){var e=Object(P.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.mediaPackageId){e.next=2;break}throw new Error("Missing mediaPackageId");case 2:return e.next=4,ee.post("".concat(x.opencast.url,"/editor/").concat(x.mediaPackageId,"/edit.json"),{segments:sn(t.segments),tracks:t.tracks});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),rn=Object(j.c)({name:"workflowPostState",initialState:nn,reducers:{},extraReducers:function(e){e.addCase(an.pending,(function(e,t){e.status="loading"})),e.addCase(an.fulfilled,(function(e,t){e.status="success"})),e.addCase(an.rejected,(function(e,t){e.status="failed",e.error=t.error.message}))}}),sn=function(e){var t=[];return e.forEach((function(e){t.push({start:e.start,end:e.end,deleted:e.deleted,selected:!1})})),t},cn=function(e){return e.workflowPostState.status},on=function(e){return e.workflowPostAndProcessState.error},ln=rn.reducer;var un={name:"vavmm1",styles:"max-width:500px"},dn=function(){var e=Object(b.b)(),t=Object(b.c)(Ae),n=Object(b.c)(He),a=Object(b.c)(cn),r=d.m,s=!1,i="Save Button";"loading"===a?(r=d.o,s=!0,i="Attempting to save"):"success"===a?(r=d.b,s=!1,i="Saved successfully"):"failed"===a&&(r=d.f,s=!1,i="Save failed");var c=function(){e(an({segments:t,tracks:n}))};return Object(l.jsx)("div",{css:[q,J,"",""],title:i,role:"button",tabIndex:0,onClick:c,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||c()}},Object(l.jsx)(u.a,{icon:r,spin:s,size:"1x"}),Object(l.jsx)("span",null,"Yes, save changes"),Object(l.jsx)("div",{css:$,"aria-live":"polite","aria-atomic":"true"},function(){if("success"===a)return"Saved successfully"}()))},bn=function(){var e=Object(b.c)(I),t=Object(b.c)(cn),n=Object(b.c)(on),a=Object(l.css)({height:"100%",display:"Save changes"!==e?"none":"flex",flexDirection:"column",alignItems:"center",gap:"30px"},"","");return Object(l.jsx)("div",{css:a,title:"Save Area"},Object(l.jsx)("h1",null,"Save current project"),Object(l.jsx)("span",{css:un},"The video will not be processed but all cutting information will be stored in Opencast. You can continue your edit later."),Object(l.jsx)("div",{css:X},Object(l.jsx)(Dn,{pageNumber:0,label:"No, take me back",iconName:d.d}),Object(l.jsx)(dn,null)),Object(l.jsx)("div",{css:Q("failed"===t),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"An error has occured. Please wait a bit and try again."),Object(l.jsx)("br",null),n?"Details: "+n:"No error details are available.",Object(l.jsx)("br",null)))},jn=Object(j.c)({name:"endState",initialState:{end:!1,value:"success"},reducers:{setEnd:function(e,t){e.end=t.payload.hasEnded,e.value=t.payload.value}}}),fn=jn.actions.setEnd,pn=function(e){return e.endState.end},xn=function(e){return e.endState.value},gn=jn.reducer,hn=function(){var e=Object(b.b)(),t=function(){e(fn({hasEnded:!0,value:"discarded"}))};return Object(l.jsx)("div",{css:[q,J,"",""],title:"Discard changes button",role:"button",tabIndex:0,onClick:t,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||t()}},Object(l.jsx)(u.a,{icon:d.r,size:"1x"}),Object(l.jsx)("span",null,"Yes, discard changes"))},mn=function(){var e=Object(b.c)(I),t=Object(l.css)({display:"Discard changes"!==e?"none":"flex",flexDirection:"column",alignItems:"center",gap:"30px"},"","");return Object(l.jsx)("div",{css:t,title:"Abort Area"},Object(l.jsx)("h1",null,"Discard changes"),Object(l.jsx)("span",null,"Discard all the changes you made? This cannot be undone!"),Object(l.jsx)("div",{css:X},Object(l.jsx)(Dn,{pageNumber:0,label:"No, take me back",iconName:d.d}),Object(l.jsx)(hn,null)))},vn={status:"idle",error:void 0},On=Object(j.b)("video/postVideoInformationWithWorkflow",function(){var e=Object(P.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.mediaPackageId){e.next=2;break}throw new Error("Missing mediaPackageId");case 2:return e.next=4,ee.post("".concat(x.opencast.url,"/editor/").concat(x.mediaPackageId,"/edit.json"),{segments:sn(t.segments),tracks:t.tracks,workflows:t.workflow});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),yn=Object(j.c)({name:"workflowPostAndProcessState",initialState:vn,reducers:{},extraReducers:function(e){e.addCase(On.pending,(function(e,t){e.status="loading"})),e.addCase(On.fulfilled,(function(e,t){e.status="success"})),e.addCase(On.rejected,(function(e,t){e.status="failed",e.error=t.error.message}))}}),wn=function(e){return e.workflowPostAndProcessState.status},Sn=function(e){return e.workflowPostAndProcessState.error},kn=yn.reducer;var In={name:"ygo0cj",styles:"padding:16px;box-shadow:0 0 10px rgba(0, 0, 0, 0.3)"},Cn=function(e){var t=e.text,n=Object(b.b)(),a=Object(b.c)(Be),r=Object(b.c)(De),s=Object(b.c)(Ae),i=Object(b.c)(He),c=Object(b.c)(wn),o=function(){n(On({segments:s,tracks:i,workflow:[{id:a[r].id}]}))},j=d.g,f=!1;"loading"===c?(j=d.o,f=!0):"success"===c?(j=d.b,f=!1,n(fn({hasEnded:!0,value:"success"}))):"failed"===c&&(j=d.f,f=!1);var p=In;return Object(l.jsx)("div",{css:[q,p,"",""],title:"Start processing button",role:"button",tabIndex:0,onClick:o,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||o()}},Object(l.jsx)(u.a,{icon:j,spin:f,size:"1x"}),Object(l.jsx)("span",null,t))},En=function(){var e=Object(b.c)(wn),t=Object(b.c)(Sn),n=Object(l.css)({display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",gap:"30px"},"","");return Object(l.jsx)("div",{css:n,title:"Workflow Configuration Area"},Object(l.jsx)("h2",null,"Workflow Configuration"),Object(l.jsx)(u.a,{icon:d.u,size:"10x"}),"Placeholder",Object(l.jsx)("div",null,"Satisfied with your configuration?"),Object(l.jsx)("div",{css:X},Object(l.jsx)(Dn,{pageNumber:1,label:"No, take me back",iconName:d.d}),Object(l.jsx)(Cn,{text:"Yes, start processing"})),Object(l.jsx)("div",{css:Q("failed"===e),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"An error has occured. Please wait a bit and try again."),Object(l.jsx)("br",null),t?"Details: "+t:"No error details are available.",Object(l.jsx)("br",null)))},An=function(e){var t=e.stateName,n=e.workflowIndex,a=Object(b.b)(),r=Object(b.c)(De),s=function(){a(ve(n))},i=Object(l.css)({backgroundColor:n!==r?"snow":"#DDD",padding:"16px"},"","");return Object(l.jsx)("div",{css:[q,i,"",""],title:"Click to select this workflow",role:"button",tabIndex:0,"aria-label":"Press to select the workflow: "+t,onClick:s,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||s()}},Object(l.jsx)("span",null,t))},Nn=function(){var e=Object(b.c)(Be),t=Object(b.c)(I),n=Object(b.c)(C),a=Object(b.c)(De),r=Object(b.c)(wn),s=Object(b.c)(Sn),i=Object(b.c)(cn),c=Object(b.c)(on),o=Object(l.css)({padding:"20px",display:"Start processing"===t&&1===n?"flex":"none",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"50px"},"",""),u=Object(l.css)({display:"flex",flexDirection:"column",alignItems:"left",gap:"20px",flexWrap:"wrap",maxHeight:"50vh"},"",""),j=function(t,n,a,r,s,i,c){return Object(l.jsx)("div",{css:o},Object(l.jsx)("h2",null,t),n,a&&Object(l.jsx)("div",{css:u,title:"Workflow Selection Area"},e.map((function(e,t){return Object(l.jsx)(An,{key:t,stateName:e.name,workflowIndex:t})}))),r,Object(l.jsx)("div",{css:X},Object(l.jsx)(Dn,{pageNumber:0,label:"Take me back",iconName:d.d}),s),Object(l.jsx)("div",{css:Q("failed"===i),title:"Error Box",role:"alert"},Object(l.jsx)("span",null,"An error has occured. Please wait a bit and try again."),Object(l.jsx)("br",null),c?"Details: "+c:"No error details are available.",Object(l.jsx)("br",null)))};return e.length<=0?j("Save and Process",Object(l.jsx)("div",null,"A problem occured, there are no workflows to process your changes with.",Object(l.jsx)("br",null),"Please save your changes and contact an Opencast Administrator."),!1,"",Object(l.jsx)(dn,null),i,c):1===e.length?j("Save and Process",Object(l.jsx)("div",null,'The video will be cut and processed with the workflow "',e[0].name,'".',Object(l.jsx)("br",null),"This will take some time."),!1,"",Object(l.jsx)(Cn,{text:"Start processing"}),r,s):j("Select a workflow",Object(l.jsx)("div",null,"Select which workflow Opencast should use for processing."),!0,Object(l.jsx)("div",null,Object(l.jsx)("i",null,e.length>a&&e[a].description?e[a].description:"\xa0")),Object(l.jsx)(Cn,{text:"Start processing"}),r,s)};var Pn={name:"1666ohp",styles:"width:200px;padding:16px;box-shadow:0 0 10px rgba(0, 0, 0, 0.3);justify-content:space-around"},Dn=function(e){var t=e.pageNumber,n=e.label,a=e.iconName,r=Object(b.b)(),s=function(){r(k(t))},i=Pn;return Object(l.jsx)("div",{css:[q,i,"",""],role:"button",tabIndex:0,onClick:s,onKeyDown:function(e){" "!==e.key&&"Enter"!==e.key||s()}},Object(l.jsx)(u.a,{icon:a,size:"1x"}),Object(l.jsx)("span",null,n))},Tn=function(){var e=Object(b.c)(C),t=Object(l.css)({display:0!==e?"none":"block"},"",""),n=Object(l.css)({display:1!==e?"none":"block"},"",""),a=Object(l.css)({display:2!==e?"none":"block"},"","");return Object(l.jsx)("div",{title:"Finish"},Object(l.jsx)("div",{css:t},Object(l.jsx)(tn,null)),Object(l.jsx)("div",{css:n},Object(l.jsx)(bn,null),Object(l.jsx)(Nn,null),Object(l.jsx)(mn,null)),Object(l.jsx)("div",{css:a},Object(l.jsx)(En,null)))};var Ln={name:"1d3w5wq",styles:"width:100%"},Rn=function(){var e=Object(b.c)(v),t=Object(l.css)({display:e!==a.cutting?"none":"flex",flexDirection:"column",justifyContent:"space-around",gap:"20px",paddingRight:"20px",paddingLeft:"20px"},"",""),n=Object(l.css)({display:e!==a.metadata?"none":"flex",gap:"20px",paddingRight:"20px",paddingLeft:"20px"},"",""),r=Object(l.css)({display:e!==a.finish?"none":"flex",flexDirection:"column",justifyContent:"space-around",gap:"20px",paddingRight:"20px",height:"100%"},"",""),s=Object(l.css)({display:e===a.cutting||e===a.finish||e===a.metadata?"none":"flex",flexDirection:"column",alignItems:"center",padding:"20px",gap:"20px"},"","");return Object(l.jsx)("main",{title:"MainMenuContext",css:Ln,role:"main"},Object(l.jsx)("div",{css:t},Object(l.jsx)(bt,null),Object(l.jsx)(At,null),Object(l.jsx)(kt,null)),Object(l.jsx)("div",{css:n},Object(l.jsx)(Zt,null)),Object(l.jsx)("div",{css:r},Object(l.jsx)(Tn,null)),Object(l.jsx)("div",{css:s},Object(l.jsx)(u.a,{icon:d.u,size:"10x"}),"Placeholder"))};var Gn={name:"1uqdbld",styles:"width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;gap:20px"},Mn=function(){var e=function(){window.location.reload(!0)};return Object(l.jsx)("div",{css:[q,J,"",""],title:"Reload the page to start over",role:"button",tabIndex:0,onClick:e,onKeyDown:function(t){" "!==t.key&&"Enter"!==t.key||e()}},Object(l.jsx)("span",null,"Let me start over!"))},Wn=function(){var e=Object(b.c)(xn),t=Object(b.c)(Re),n=Gn;return Object(l.jsx)("div",{css:n,title:"The End"},Object(l.jsx)(u.a,{icon:"discarded"===e?d.r:d.c,size:"10x"}),Object(l.jsx)("div",null,"discarded"===e?"All your changes are now lost forever. You can now close the editor.":"success"===e?"Changes successfully saved to Opencast. Processing your changes may take up to\n              ".concat(new Date(2*t).toISOString().substr(11,8)," hours.\n              You can now close the editor."):void 0),"discarded"===e&&Object(l.jsx)(Mn,null))},Hn=function(){var e=Object(b.c)(pn),t={display:"flex",flexDirection:"row",height:"100%"};return Object(l.jsx)(s.a.Fragment,null,e?Object(l.jsx)(Wn,null):Object(l.jsx)("div",{css:t,title:"Body"},Object(l.jsx)(ze,null),Object(l.jsx)(Rn,null)))};var Bn,Un=function(){return Object(l.jsx)("div",{className:"App"},Object(l.jsx)(Y,null),Object(l.jsx)(Hn,null))},Vn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,276)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))},Fn=Object(j.a)({reducer:{mainMenuState:O,finishState:E,videoState:Ve,workflowPostState:ln,workflowPostAndProcessState:kn,endState:gn,metadataState:Ut}}),zn=n(19),Kn=Promise.race([M(),(Bn=300,new Promise((function(e,t){return setTimeout(e,Bn)})))]);Kn.then((function(){c.a.render(Object(l.jsx)(s.a.StrictMode,null,Object(l.jsx)(b.a,{store:Fn},Object(l.jsx)(zn.a,{utils:Yt.a},Object(l.jsx)(Un,null)))),document.getElementById("root"))}),(function(e){return t=Object(l.jsx)("p",null,"Fatal error while loading app: ".concat(e.message),Object(l.jsx)("br",null),"This might be caused by a incorrect configuration by the system administrator."),void c.a.render(t,document.getElementById("root"));var t})),Vn()}},[[243,1,2]]]);
//# sourceMappingURL=main.df41af7a.chunk.js.map